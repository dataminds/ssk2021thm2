---
title: "SSK심포지움I: 팬데믹 시기 삶의 양식과 마음건강"
subtitle: "대면소통 및 미디어이용이 정신건강에 미치는 차별적 영향"
author: "안도현(제주대학교)"
institute: "서울대 팬데믹과 포스트팬데믹 시기 디지털소통양식과 정신건강 SSK사업단"
date: "2022-1-19"
output:
  xaringan::moon_reader:
    css: 
      - [default]
      - css/rconf.css
      - css/rconf-fonts.css
    lib_dir: libs
    seal: false
    nature:
      highlightStyle: googlecode
      highlightLines: true
      highlightLanguage: ["r"]
      countIncrementalSlides: false
      ratio: "16:9"
    includes:
      after_body: [css/rconf-logo.html]
editor_options: 
  chunk_output_type: console
---

```{r setup, include = FALSE}
library(tidyverse)

options(
  htmltools.dir.version = FALSE, 
  htmltools.preserve.raw = FALSE,
  tibble.width = 60, tibble.print_min = 6,
  crayon.enabled = TRUE
)

knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE,
                      comment="", digits = 3, tidy = FALSE, prompt = FALSE, fig.align = 'center',
                      fig.width = 7.252,
                      fig.height = 4,
                      dpi = 300)

# uncomment the following lines if you want to use the NHS-R theme colours by default
# scale_fill_continuous <- partial(scale_fill_nhs, discrete = FALSE)
# scale_fill_discrete <- partial(scale_fill_nhs, discrete = TRUE)
# scale_colour_continuous <- partial(scale_colour_nhs, discrete = FALSE)
# scale_colour_discrete <- partial(scale_colour_nhs, discrete = TRUE)
```


class: title-slide, left, bottom

# `r rmarkdown::metadata$title`
----
## **`r rmarkdown::metadata$subtitle`**
### `r rmarkdown::metadata$author`
### `r rmarkdown::metadata$date`

---
class: inverse, middle
name: data-science-case

# .warmyellow[발표 개요]

----

.pull-left[

.burlywood[연구문제]

**.tomato[I. 대면소통 및 미디어이용이 정신건강에 미치는 차별적 영향: 고립감과 소속연결감의 매개효과]**

1. 미디어이용은 사회관계의 대체재로서 대면소통을 증강하는가 전치하는가? 

2. 고립감 및 소속연결감이 대면소통 및 미디어이용과 불안녕감 및 안녕감 사이의 관계를 차별적으로 매개하는가?

3. 미디어이용의 각 유형은 대면소통, 고립감 및 소속연결감, 불안녕감 및 안녕감 사이의 매개관계를 조절하는가?  


]

.pull-right[   
.left[

**.CornflowerBlue[순 서]** 

1. [개념 & 가설](#concepts1)
  1. [미디어이용과 대면소통: 증강 vs. 전치](#concepts1)  
  2. [정신건강: 안녕감과 불안녕감](#hypo1)   
  3. [사회관계: 고립감과 소속연결감](#method1)  

2. [방 법](#method1)  

3. [결 과](#results1)  

4. [논 의](#discussion1)  

]
] <!--end of right-column-->


<!--------------------------  슬라이드 본문 시작 ------------------------------------->

---
name: concepts1
# 1. 대면소통과 미디어이용

**.tomato[I. 미디어이용과 대면소통: 증강 vs. 전치]**

1. 미디어이용은 사회관계의 대체재로서 대면소통을 증강하는가 전치하는가? 



---
name: hypo1
# 가설 & 연구질문1

**.tomato[미디어이용은 사회관계의 대체재로서 대면소통을 증강하는가 전치하는가?]  **

- **증강가설(augmenttaion hypothesis):**  

  H1a: 미디어이용이 대면소통을 증강하므로 미디어이용 시간이 많을수록 대면소통시간은 증가할 것이다. 
  
- **전치가설(displacement hypothesis):**  

  H1b- 미디어이용이 대면소통을 전치하므로 미디어이용 시간이 많을수록 대면소통시간은 감소할 것이다. 
  
  
RQ1a: 미디어의 유형별(핸드폰, 스마트기기, 컴퓨터, TV, 종이)이용 시간은 대면소통시간의 관련성은 차별적으로 나타날 것인가? 

RQ1b: 미디어 이용양식(관계이용, 정보이용, 오락이용)에 따른 이용시간은 대면소통시간의 관련성은 차별적으로 나타날 것인가? 

  
.footnote[
 
]


---
name: concepts2
# 2. 정신건강

**.tomato[II. 대면소통과 미디어이용의 정신건강의 두 측면(불안녕감 & 안녕감)에 대한 차별적 영향]**

2. 대면소통과 미디어이용은 이용자의 정신건강의 두 측면(불안녕감과 안녕감)에 차별적 영향을 미치는가?  




---
name: concepts3
# 3. 사회관계

**.tomato[III. 사회관계 두 측면(고립감 & 소속연결감)의 차별적 매개효과]**



---
name: hypo3
# 가설 & 연구질문3

**.tomato[사회관계성의 두 측면(고립감 & 소속연결감)은 대면소통과 미디어이용의 정신건강에 대한 영향은 차별적으로 매개할 것인가?]**  

- **증강가설(augmenttaion hypothesis):**  

  H3a: 미디어이용이 대면소통을 증강하므로 미디어이용 증가는 고립감 감소와 소속연결감 증가를 통해  정신건강의 두 측면(불안녕감과 안념감)에 긍정적으로 영향을 미칠 것이다.  


- **전치가설(displacement hypothesis):**  

  H3b: 미디어이용이 대면소통을 전치하므로 미디어이용 증가는 고립감 증대와 소속연결감 감소를 통해 정신건강의 두 측면(불안녕감과 안녕감)에 부정적 영향을 미칠 것이다.  


RQ3: 미디어 이용양식(관계이용, 정보이용, 오락이용)에 따른 이용시간은 고립감과 소속연결감을 통해 정신건강의 두 측면(불안녕감과 안녕감)에 차별적으로 영향을 미칠 것인가? 



```{r message=TRUE, warning=TRUE, include=FALSE}
if(!require(remote)) install.packages("remote")
if(!require(gtExtras)) remotes::install_github("jthomasmock/gtExtras")
if(!require(processR)) remotes::install_github("cardiomoon/processR")

c("summarytools", "psych", "lm.beta", "lavaan", "mediation", "processR",
  "writexl", "readxl", "gt", "kableExtra", "gtExtras",  
  "janitor", "here", "corrr", "Hmisc", "correlation",
  "see", "ggraph", 
  "tidyverse", "tidytext", "lubridate") -> pkg_v
pkg_v %in% installed.packages()[,"Package"] -> pkg_installed
( pkg_v[!pkg_installed] -> pkg_new )

if(length(pkg_new)) install.packages(pkg_new)

lapply(pkg_v, require, ch = T)

readRDS("data/v5889.rds") -> v5889_df; v5889_df -> df
df %>% group_by(성) %>% summarise(N = n(), P = N/nrow(df)*100) -> sex_df
df %>% group_by(학력) %>% summarise(N = n(), P = N/nrow(df)*100) -> edu_df

df %>% summarise(M = mean(나이), SD = sd(나이)) -> age_df
df %>% summarise(M = mean(소득), SD = sd(소득)) -> income_df


options(digits = 1)
```

---
name: method1
# 참가자

- 설문전문업체에 등록된 패널에 설문참가 안내 이메일을 보내 자료를 수집했다. 업체의 설문풀에 등록된 사람 중 8,196명이 설문안내 이메일을 통해 접속했다. 이중 5,967명이 응답을 완료했다. 불성실 응답자를 제외한 5889명(남성 = `r sex_df$N[1]`; 나이 *M* = `r age_df$M`, *SD* = `r age_df$SD`)을 최종 분석 대상에 포함했다.

- 응답자의 교육수준은 `r edu_df$N[11]+edu_df$N[12]`명(`r edu_df$P[11]+edu_df$P[12]`%)이 석사 또는 박사학위 취득, `r edu_df$N[8]+edu_df$N[9]+edu_df$N[10]`명(`r edu_df$P[8]+edu_df$P[9]+edu_df$P[10]`%)이 대학 재학/중퇴/졸업, `r edu_df$N[5]+edu_df$N[6]+edu_df$N[7]`명(`r edu_df$P[5]+edu_df$P[6]+edu_df$P[7]`%)이 전문대학 재학/중퇴/졸업, `r edu_df$N[4]`명(`r edu_df$P[4]`%)이 고등학교 졸업, `r edu_df$N[1]+edu_df$N[2]+edu_df$N[3]`명(`r edu_df$P[1]+edu_df$P[2]+edu_df$P[3]`%)이 무학/초등학교졸업/중학교졸업이다. 

- 연간 가구소득은 월평균으로 100만원씩 증가하는 12점 척도(1 = 100만원 미만,  12 = 1,100만원 이상)로 측정했다(*M* = `r income_df$M`, *SD* = `r income_df$SD`). 


- 설문참여자들은 설문사이트에 접속해 설문에 대한 간단한 소개, 개인정보 보호 및 위험과 권리 등에 대해 안내를 받은 후, 인구통계 정보를 기입한 다음, 다른 연구주제의 설문 문항에 답한 후, 이 연구의 설문 문항에 응답했다. 

- 자료수집에 대해서는 기관생명윤리위원회의 심의를 받았다. 

---
name: method2iv1
# 측정1a: 대면소통

4개 유형(같이 살고 있는 사람, 비동가 가족 혹은 친척, 업무/학업 목적의 지인/친구/동료, 사적인 목적의 지인/친구/동료)의 사람들과의 접촉 빈도("지난 한 달 평균 귀하는 다음의 사람들과 얼마나 자주 직접 만나서 대화를 하셨습니까?")를 통해 측정했다(1 = 전혀 안했다, 9 = 한 시간에 여러번). 


---
name: method2iv2
# 측정1b: 미디어이용

미디어이용에 대해 Rosen et al. (2013)과 권호열 등(2020)을 참조하여 유형 별로 5종(핸드폰 (스마트폰 제외), 스마트 기기(스마트폰, 스마트TV, 태블릿 등), 컴퓨터(노트북 혹은 데스크탑PC), TV, 및 종이(책 또는 신문))으로 구분해 질문 문항을 제시했다. 미디어 이용 시간은 한달 기준으로 9점척도(1 = 전혀 교류(or 이용)하지 않았다, 9 = 한 시간에 여러 번)로 측정했다. 

  
.footnote[
 
Rosen, L. D., Whaling, K., Carrier, L. M., Cheever, N. A., & Rokkum, J. (2013). The media and technology usage and attitudes scale: An empirical investigation. _Computers in Human Behavior, 29_(6), 2501-2511.

권호열 등 (2020). <2020한국미디어패널조사>. 정보통신정책연구원 https://stat.kisdi.re.kr/kor/contents/ContentsList.html

]

---
name: method2iv3
# 측정1c: 미디어이용양식

미디어이용양식은 관계이용, 정보이용, 오락이용 등 3개 양식으로 구분해 Rosen et al. (2013)과 권호열 등(2020)을 참조하고 한국인의 최근 미디어 이용 양식을 반영해 각 유형별 5~6 종의 미디어 이용 시간을 한달 기준으로 9점척도(1 = 전혀 교류(or 이용)하지 않았다, 9 = 한 시간에 여러 번)로 측정했다. 

  - 관계이용("귀하는 지난 한 달간 각 매체를 통해 다른 사람들과 얼마나 자주 교류하셨습니까?")은 음성통화, 문자메신저(휴대폰문자, 카카오톡, 네이트온, 라인 등), 화상통화(페이스타임, 카카오톡 영상통화), SNS(페이스북, 인스타그램, 트위터, 카카오스토리 등), 이메일, 온라인 커뮤니티 및 게시판 등 6종의 미디어 이용에 대해 각각 질문해 평균을 계산했다. 
  
  - 정보이용("귀하는 지난 한 달 간 아래 각 매체를 통해 얼마나 자주 뉴스/정보를 이용하셨습니까?")은  TV뉴스, 라디오, 종이신문, 인터넷 포털/언론사 홈페이지, SNS(페이스북, 인스타그램, 트위터, 카카오스토리 등), 동영상 스트리밍 사이트(유튜브, 트위치, 아프리카TV 등) 등 6종의 미디어 이용에 각각 질문해 평균을 계산했다. 
  
  - 오락이용("귀하는 지난 한 달간 무료함을 달래거나 오락을 위해 아래 각 컨텐츠를 얼마나 자주 이용하셨습니까?")은 영화/드라마, 웹툰, 컴퓨터/온라인게임, 스포츠중계, 음악/뮤직비디오 등 5종의 미디어 이용에 각각 질문해 평균을 계산했다.  

.footnote[
 
Rosen, L. D., Whaling, K., Carrier, L. M., Cheever, N. A., & Rokkum, J. (2013). The media and technology usage and attitudes scale: An empirical investigation. _Computers in Human Behavior, 29_(6), 2501-2511.

권호열 등 (2020). <2020한국미디어패널조사>. 정보통신정책연구원 https://stat.kisdi.re.kr/kor/contents/ContentsList.html

]

---
name: method3
# 측정2: 정신건강  

정신건강은 불안녕감과 안녕감 두 측면으로 구분해 측정했다. 

- 불안녕감

  정신건강진단도구로 널리 사용되는 Goldberg & Hiller(1979)의 일반건강설문지(General Health Questionnaire) 12문항 축약형을 박종익 등(2012)이 한국어로 개발한 한국판 일반건강 설문지에서 문항 4개 추출해 7점 척도((1 = 전혀 그렇지 않다, 7 = 매우 그렇다)로 측정했다. 대규모 설문수집이라 12문항을 모두 이용하지 않고 우울불안과 같은 불안녕감에 대한 문항으로서 요인적재치가 높은 4문항("근심 때문에 잠을 잘 자지 못한다,"  "닥친 문제를 극복할 수 없다고 느낀다,"  "불행하거나 우울하다고 느낀다,"  "항상 긴장하고 있다고 느낀다")을 선별했다 (&alpha; = 0.86) . 

- 안녕감

  삶의 만족에 대해 단일 문항("나는 내 삶에 만족한다")을 이용해 7점 척도로 측정했다 (1 = 전혀 그렇지 않다, 7 = 매우 그렇다). 단일 문항의 측정 신뢰성이 확인돼 있다 (Lucas & Brent, 2012).
  

.footnote[

박종익, 김영주, & 조맹제. (2012). 한국판 일반 건강 설문지의 요인 구조. <신경정신의학>, 51, 178-184.  
Goldberg, D.P., Hillier, V.F. (1979) A scaled version of the General Health Questionnaire. _Psychological Medicine 9_, 139-145.  
Lucas, R. E., & Brent Donnellan, M. (2012). Estimating the reliability of single-item life satisfaction measures: Results from four national panel studies. _Social Indicators Research, 105_(3), 323-331. https://doi.org/10.1007/s11205-011-9783-z  

]


---
name: method4
# 측정3: 사회관계

사회관계는 개정판 UCLA 외로움 척도(Russell et al., 1980)에서 3요인(고립, 소속, 연결)을 구분한 (Hawkley et al., 2005)를 토대로 고립감과 소속연결감에 해당하는 문항을 이용해 측정했다. 대규모 설문수집이라 20문항을 모두 이용하지 않고, 고립, 소속, 연결 등 각 요인의 적재치를 기준으로 고립감 2개 문항("나는 사람들과 교류가 부족하다," "나는 다른 사람들로부터 소외감을 느낀다")을 선별했고(*r* = .63), 소속연결 4개 문항("나는 내 주위 사람들과 마음이 통한다,"
"나는 내 주위 사람들과 많은 공통점을 가지고 있다," "나와 함께 얘기를 나눌 수 있는 사람들이 있다," "나는 의지할 사람들이 있다")을 선별했다(&alpha; = .89). Kim (1997)의 한국어판 문항을 커뮤니케이션학 연구자 7인이 공동으로 각 문항의 한국어 표현을 가다듬었다. 7점 척도((1 = 전혀 그렇지 않다, 7 = 매우 그렇다)로 측정했다.



.footnote[

Hawkley, L. C., Browne, M. W., & Cacioppo, J. T. (2005). How can I connect with thee? Let me count the ways. _Psychological Science, 16_(10), 798-804.

Kim, O. S. (1997). Korean version of the revised UCLA Loneliness Scale: Reliability
and validity test. _Journal of Korean Academy of Nursing, 27_, 871–879.

Russell, D., Peplau, L. A., & Cutrona, C. E. (1980). The revised UCLA Loneliness Scale: concurrent and discriminant validity evidence. _Journal of Personality and Social Psychology, 39_(3), 472.

]



```{r}
apa_style <- function(data) {
  data %>%
    opt_table_lines(extent = "none") %>%
    tab_options(
      heading.border.bottom.width = 2,
      heading.border.bottom.color = "black",
      heading.border.bottom.style = "solid",
      table.border.top.color = "white",
      table_body.hlines.color = "white",
      table_body.border.top.color = "black",
      table_body.border.top.style = "solid",
      table_body.border.top.width = 1,
      heading.title.font.size = 12,
      table.font.size = 12,
      heading.subtitle.font.size = 12,
      table_body.border.bottom.color = "black",
      table_body.border.bottom.width = 1,
      table_body.border.bottom.style = "solid",
      column_labels.border.bottom.color = "black",
      column_labels.border.bottom.style = "solid",
      column_labels.border.bottom.width = 1
    ) %>%
      opt_table_font(font = "times")
}
```

---
name: results
# 결과: 기술통계



```{r echo=FALSE, message=FALSE, warning=FALSE}
apply_if <- function(mat, p, f) {
  # Fill NA with FALSE
  p[is.na(p)] <- FALSE
  mat[p] <- f(mat[p])
  mat
}
apaCorr <- function(mat, corrtype = "spearman") {
  matCorr <- mat
  if (class(matCorr) != "rcorr") {
    matCorr <- rcorr(mat, type = corrtype)
  }

  # Add one star for each p < 0.05, 0.01, 0.001
  stars <- apply_if(round(matCorr$r, 2), matCorr$P < 0.05, function(x) paste0(x, "*"))
  stars <- apply_if(stars, matCorr$P < 0.01, function(x) paste0(x, "*"))
  stars <- apply_if(stars, matCorr$P < 0.001, function(x) paste0(x, "*"))
  # Put - on diagonal and blank on upper diagonal
  stars[upper.tri(stars, diag = T)] <- "-"
  stars[upper.tri(stars, diag = F)] <- ""
  n <- length(stars[1,])
  colnames(stars) <- 1:n
  # Remove _ and convert to title case
  row.names(stars) <- tools::toTitleCase(sapply(row.names(stars), gsub, pattern="_", replacement = " "))
  # Add index number to row names
  row.names(stars) <- paste(paste0(1:n,"."), row.names(stars))
  stars
}

options(digits = 3)
v5889_df %>% dplyr::select(대면빈도, 미디어시간, 관계이용, 정보이용, 오락이용, 관계_고립, 관계_소속연결, 우울불안, 삶만족) -> df

df %>% map_dfc(mean) %>% fashion(decimals = 2) %>% as_tibble() %>% 
  pivot_longer(everything(), names_to = "Mname", values_to = "M") -> mean_df
df %>% map_dfc(sd) %>% fashion(decimals = 2) %>% as_tibble() %>% 
  pivot_longer(everything(), names_to = "SDname", values_to = "SD") -> sd_df
df %>% corrr::correlate() %>% shave(upper = T) %>% 
  fashion(decimals = 2, na_print = "-") %>% as_tibble() -> cor_df
df %>% as.matrix() %>% apaCorr(corrtype = "pearson") %>% 
  as.data.frame() -> cor_df
tibble(Variable = c(
  "1. F2F Frequency ",
  "2. Media Use",
  "3. Media Use: Relation",
  "4. Media Use: Information",
  "5. Media Use: Entertainment",
  "6. Isolation",
  "7. Connectedness",
  "8. Ill-being",
  "9. Well-being"
)) -> row_df

bind_cols(row_df, mean_df[2], sd_df[2], cor_df) %>% 
  gt() %>% gt_theme_guardian() %>% 
  tab_header(md("**Table 1.** Descriptive Statistics and Correlations(Pearson) for Study Variables(*N* = 5889)")
  ) %>% cols_label(
    M = md("*M*"), SD = md("*SD*")
  ) %>% cols_width(
    Variable ~ px(220)
  ) %>% tab_source_note(
    source_note = md("_Note._ * _p_ < .05,  ** _p_ < .01,  *** _p_ < .001  
                     F2F = Face-to-Face")
  ) 

```



---
name: results1a
# 결과: 가설1: 미디어이용과 대면소통
.left-column2[

미디어이용이 대면소통을 증강하는지 혹은 전치하는지 검정하기 위해 편상관분석을 이용해 미디어이용시간과 대면소통시간의 관계를 분석했다.  
]

.right-column8[


```{r}
apply_if <- function(mat, p, f) {
  # Fill NA with FALSE
  p[is.na(p)] <- FALSE
  mat[p] <- f(mat[p])
  mat
}

apaCorr <- function(mat, corrtype = "pearson") {
  matCorr <- mat
  if (class(matCorr) != "rcorr") {
    matCorr <- rcorr(mat, type = corrtype)
  }

  # Add one star for each p < 0.05, 0.01, 0.001
  stars <- apply_if(round(matCorr$r, 2), matCorr$P < 0.05, function(x) paste0(x, "*"))
  stars <- apply_if(stars, matCorr$P < 0.01, function(x) paste0(x, "*"))
  stars <- apply_if(stars, matCorr$P < 0.001, function(x) paste0(x, "*"))
  # Put - on diagonal and blank on upper diagonal
  stars[upper.tri(stars, diag = T)] <- "-"
  stars[upper.tri(stars, diag = F)] <- ""
  n <- length(stars[1,])
  colnames(stars) <- 1:n
  # Remove _ and convert to title case
  row.names(stars) <- tools::toTitleCase(sapply(row.names(stars), gsub, pattern="_", replacement = " "))
  # Add index number to row names
  row.names(stars) <- paste(paste0(1:n,"."), row.names(stars))
  stars
}

options(digits = 3)
v5889_df %>% dplyr::select(
  대면빈도, 
  미디어시간, 관계이용, 정보이용, 오락이용, 
  성, 나이, 학력, 소득) -> df

# 편상관분석 represented as Gaussian graphical models
df %>% correlation(partial = T) -> pcor_df
pcor_df %>% plot() 

```
Gaussian Graphical Models of Partial Correlations
]

---
name: results1b
# 결과: 가설1: 미디어이용과 대면소통

.left-column2[

]


.right-column8[

```{r}
# pcor_df %>% names()

# 편상관분석. 대면빈도만 표 구성.
pcor_df %>% 
  filter(Parameter1 == "대면빈도") %>% 
  dplyr::select(Variable1 = Parameter1,
                Variable2 = Parameter2,
                r = r, t = t, p = p,
                LL = CI_low, UL = CI_high) %>% 
  mutate(
    Variable1 = recode(Variable1, 대면빈도 = "F2F Frequency"),
    Variable2 = recode(Variable2, 
                       미디어시간 = "Media Use",
                       관계이용 = "Media Use: Relation",
                       정보이용 = "Media Use: Information",
                       오락이용 = "Media Use: Entertainment",
                       성 = "Sex(0 = Male)",
                       나이 = "Age", 
                       학력 = "Education",
                       소득 = "Income")
    ) %>% 

gt() %>% gt_theme_guardian() %>% 
  tab_header(md(
    "**Table 2.** Partial Correlations(Pearson) for F2F Frequency and Media Uses(*N* = 5889)") 
#  ) %>% cols_label(
#    M = md("*M*"), SD = md("*SD*")
#  ) %>% cols_width(
#    Variable ~ px(220)
  ) %>% cols_label(
    r = md("*r*"), 
    t = md("_t_"),
    p = md("*p*"),
    LL = md("*LL*"),
    UL = md("*UL*")
  ) %>% tab_spanner(
    label = "95% CI", columns = c("LL", "UL")
  ) %>% fmt_number(
    columns = c(r, t, LL, UL), decimals = 2
  ) %>% fmt_number(
    columns = p, decimals = 3
  ) %>% tab_source_note(md(
  "_Note._ * _p_ < .05,  ** _p_ < .01,  *** _p_ < .001 
  <br>   _CI_ = Confidence Interval; _LL_ = Lower Limit; _UL_ = Upper Limit.  ")
  )

```

]

---
name: results1c
# 결과: 가설1: 미디어 기기별 이용과 대면소통

```{r}
options(digits = 3)
v5889_df %>% dplyr::select(
  대면빈도, 
  미_핸드폰, 미_스마트, 미_컴퓨터, 미_티비, 미_종이,
  성, 나이, 학력, 소득) -> df

# 편상관분석 represented as Gaussian graphical models
df %>% correlation(partial = T, method = "spearman") -> pcor_df
# df %>% pairs.panels()


```


.left-column2[
핸드폰, 스마트기기, PC, 종이이용의 분포가 비정규성이어서 서열기반 상관분석(스피어만) 수행. 
스마트기기만 상관성 부재. 
]


.right-column8[

```{r}
# pcor_df %>% names()

# 편상관분석. 대면빈도만 표 구성.
pcor_df %>% 
  filter(Parameter1 == "대면빈도") %>% 
  dplyr::select(Variable1 = Parameter1,
                Variable2 = Parameter2,
                rho = rho, S = S, p = p,
                LL = CI_low, UL = CI_high) %>% 
  mutate(
    Variable1 = recode(Variable1, 대면빈도 = "F2F Frequency"),
    Variable2 = recode(Variable2, 
                       미_핸드폰 = "Cellphone Use",
                       미_스마트 = "Smart Device Use",
                       미_컴퓨터 = "PC Use",
                       미_티비 = "TV Use",
                       미_종이 = "Paper Use",
                       성 = "Sex(0 = Male)",
                       나이 = "Age", 
                       학력 = "Education",
                       소득 = "Income")
    ) %>% 

gt() %>% gt_theme_guardian() %>% 
  tab_header(md(
    "**Table 3.** Partial Correlations(Spearman) for F2F Frequency and Uses of Media(*N* = 5889)") 
#  ) %>% cols_label(
#    M = md("*M*"), SD = md("*SD*")
#  ) %>% cols_width(
#    Variable ~ px(220)
  ) %>% cols_label(
    rho = md("_&rho;_"), 
    S = md("_S_"),
    p = md("*p*"),
    LL = md("*LL*"),
    UL = md("*UL*")
  ) %>% tab_spanner(
    label = "95% CI", columns = c("LL", "UL")
  ) %>% fmt_number(
    columns = c(rho, LL, UL), decimals = 2
  ) %>% fmt_number(
    columns = c(S), decimals = 0
  ) %>% fmt_number(
    columns = p, decimals = 3
  ) %>% tab_source_note(md(
  "_Note._ * _p_ < .05,  ** _p_ < .01,  *** _p_ < .001 
  <br>   _CI_ = Confidence Interval; _LL_ = Lower Limit; _UL_ = Upper Limit. F2F = Face to Face   ")
  )

```
]

                         
```{r eval=FALSE, message=FALSE, warning=FALSE, include=FALSE}
# 통계치 템플릿. 여기서 나온 결과를 복사해서 md()안에 붙여넣기
glue::glue(
  "_F_({fstat_v[2]}, {fstat_v[3]}) = {round(fstat_v[1], 2)}, p < .001, R<sup>2</sup> = {round(rsq_v, 2)}, _&Delta;R<sup>2</sup>_ = {round(adjrsq_v, 2)}"
)
```


---
name: results2a0
# 모형: 매개 모형

- X: 대면소통, 관계이용, 정보이용, 오락이용  
- MI: 고립감, 소속연결감  
- Y: 불안녕감, 안녕감  

```{r}
pmacroModel(4)

```




---
name: results2a
# 결과: 가설2a: 고립/소속연결감 - 불안녕감 매개

.left-column2[
대면소통은 고립감과 소속연결감이 불안녕감을 매개. 관계이용, 정보이용, 오락이용은 매개하지 않는다. 
]

.right-column8[

```{r}
v5889_df -> df
X <- c("대면빈도", "관계이용", "정보이용", "오락이용")
M <- c("관계_고립", "관계_소속연결")
Y <- c("우울불안", "삶만족")[1]
W <- "성+나이+소득+학력"

par(mfrow = c(2,4))
out_l <- list()
for(j in seq_along(M)) {
  for(i in seq_along(X)) {
  M_fmla <- paste0(M[[j]], "~", X[[i]], "+", W)
  Y_fmla <- paste0(Y, "~", X[[i]], "+", M[[j]], "+", W)
  
  med_fit <- lm(M_fmla, data = df)
  out_fit <- lm(Y_fmla, data = df)
  med_out <- mediation::mediate(
    med_fit, out_fit, treat = X[[i]], mediator = M[[j]], boot = T, sims = 100)
  plot(med_out, main = paste(X[[i]], "-", M[[j]], "-", Y, sep = " "))
  out_l[[i]] <- summary(med_out)
  }
}

```
]
.footnote[

]


---
name: results2b
# 결과: 가설2b: 고립/소속연결감 - 안녕감 매개

.left-column2[
고립감은 모든 경우에 안녕감을 매개하지 않지만, 소속연결감은 부분매개. 
]

.right-column8[

```{r}
X <- c("대면빈도", "관계이용", "정보이용", "오락이용")
M <- c("관계_고립", "관계_소속연결")
Y <- c("우울불안", "삶만족")[2]
W <- "성+나이+소득+학력"

par(mfrow = c(2,4))
out_l <- list()
for(j in seq_along(M)) {
  for(i in seq_along(X)) {
  M_fmla <- paste0(M[[j]], "~", X[[i]], "+", W)
  Y_fmla <- paste0(Y, "~", X[[i]], "+", M[[j]], "+", W)
  
  med_fit <- lm(M_fmla, data = df)
  out_fit <- lm(Y_fmla, data = df)
  med_out <- mediation::mediate(
    med_fit, out_fit, treat = X[[i]], mediator = M[[j]], boot = T, sims = 100)
  plot(med_out, main = paste(X[[i]], "-", M[[j]], "-", Y, sep = " "))
  out_l[[i]] <- summary(med_out)
  }
}

```
]

.footnote[

]




```{r eval=FALSE, message=FALSE, warning=FALSE, include=FALSE}
glue::glue(
  "_F_({fstat_v[2]}, {fstat_v[3]}) = {round(fstat_v[1], 2)}, p < .001, R<sup>2</sup> = {round(rsq_v, 2)}, _&Delta;R<sup>2</sup>_ = {round(adjrsq_v, 2)}"
)
```



---
name: results2e
# 결과: 대면소통 매개 요약 

.left-column3[
대면소통은 우울불안에 대해 고립감과 소속연결이 모두 매개. 반면, 삶만족에 대해서는 소속연결감만 매개하고, 고립감은 매개하지 않는다. 
]

.right-column7[
```{r}
X <- c("대면빈도", "관계이용", "정보이용", "오락이용")[1]
M <- c("관계_고립", "관계_소속연결")
Y <- c("우울불안", "삶만족")
W <- "성+나이+소득+학력"

par(mfrow = c(2,2))
out_l <- list()
for (i in seq_along(M)) {
  for (j in seq_along(Y)) {
    M_fmla <- paste0(M[[i]], "~", X, "+", W)
    Y_fmla <- paste0(Y[[j]], "~", X, "+", M[[i]], "+", W)
    
    med_fit <- lm(M_fmla, data = df)
    out_fit <- lm(Y_fmla, data = df)
    med_out <- mediation::mediate(
      med_fit,
      out_fit,
      treat = X,
      mediator = M[[i]],
      boot = T,
      sims = 100
    )
    plot(med_out, main = paste(X, "-", M[[i]], "-", Y[[j]], sep = " "))
    out_l[[i]] <- summary(med_out)
  }
}
```
]  

.footnote[

]


---
name: results3a0
# 모형: 매개된 조절모형


- X: 대면소통  
- MI: 고립감, 소속연결감  
- Y: 불안녕감, 안녕감  
- W: 관계이용, 정보이용, 오락이용  

```{r}
pmacroModel(8)

```


---
name: results3a1
# 결과: 가설3a1: 불안녕감: 관계이용 조절매개

.left-column2[

]


.right-column8[

```{r}
v5889_df  -> df
df %>% 
  mutate(관계이용상하 = case_when(
    관계이용 <= quantile(df$관계이용, probs = .3) ~ 3,
    관계이용 >= quantile(df$관계이용, probs = .7) ~ 7, 
    TRUE ~ 5)) -> df

X <- c("대면빈도", "관계이용", "정보이용", "오락이용")[1]
M <- c("관계_고립", "관계_소속연결")
Y <- c("우울불안", "삶만족")[1]
W <- "성+나이+소득+학력"
I <- "관계이용상하"

par(mfrow = c(2,3))
out2_l <- list()
out6_l <- list()
test_l <- list()
for(i in seq_along(M)) {
  for (j in seq_along(Y)) {
    M_fmla <- paste0(M[[i]], "~", X, "*", I, "+", W)
    Y_fmla <-
      paste0(Y[[j]], "~", M[[i]], "+", X, "*", I, "+", M,"+", W)
    
    med_fit <- lm(M_fmla, data = df)
    out_fit <- lm(Y_fmla, data = df)
    med2_out <- mediation::mediate(
      med_fit,
      out_fit,
      treat = X,
      mediator = M[[i]],
      covariates = list(관계이용상하  = 3),
      sims = 100
    )
    med4_out <- mediation::mediate(
      med_fit,
      out_fit,
      treat = X,
      mediator = M[[i]],
      covariates = list(관계이용상하  = 5),
      sims = 100
    )
    med6_out <- mediation::mediate(
      med_fit,
      out_fit,
      treat = X,
      mediator = M[[i]],
      covariates = list(관계이용상하  = 7),
      sims = 100
    )
    med_init <-
      mediation::mediate(
        med_fit,
        out_fit,
        treat = X,
        mediator = M[[i]],
        sims = 100
      )
    test_l[[i]] <- test.modmed(
      med_init,
      covariates.1 = list(관계이용상하  = 3),
      covariates.2 = list(관계이용상하  = 7)
    )
    plot(med2_out, main = paste(X, "-", M[[i]], "-", Y[[j]]), sub = paste(I, "= Low"))
    
    plot(med4_out, main = paste(X, "-", M[[i]], "-", Y[[j]]), sub = paste(I, "= Mid"))
    
    plot(med6_out, main = paste(X, "-", M[[i]], "-", Y[[j]]), sub = paste(I, "= High"))
    out2_l[[i]] <- summary(med2_out)
    out6_l[[i]] <- summary(med6_out)
  }
}

```

]

.footnote[

]


---
name: results3a2
# 결과: 가설3a2: 안녕감: 관계이용 조절매개

.left-column2[

]


.right-column8[

```{r}
v5889_df  -> df
df %>% 
  mutate(관계이용상하 = case_when(
    관계이용 <= quantile(df$관계이용, probs = .3) ~ 3,
    관계이용 >= quantile(df$관계이용, probs = .7) ~ 7, 
    TRUE ~ 5)) -> df

X <- c("대면빈도", "관계이용", "정보이용", "오락이용")[1]
M <- c("관계_고립", "관계_소속연결")
Y <- c("우울불안", "삶만족")[2]
W <- "성+나이+소득+학력"
I <- "관계이용상하"

par(mfrow = c(2,3))
out2_l <- list()
out6_l <- list()
test_l <- list()
for(i in seq_along(M)) {
  for (j in seq_along(Y)) {
    M_fmla <- paste0(M[[i]], "~", X, "*", I, "+", W)
    Y_fmla <-
      paste0(Y[[j]], "~", M[[i]], "+", X, "*", I, "+", M,"+", W)
    
    med_fit <- lm(M_fmla, data = df)
    out_fit <- lm(Y_fmla, data = df)
    med2_out <- mediation::mediate(
      med_fit,
      out_fit,
      treat = X,
      mediator = M[[i]],
      covariates = list(관계이용상하  = 3),
      sims = 100
    )
    med6_out <- mediation::mediate(
      med_fit,
      out_fit,
      treat = X,
      mediator = M[[i]],
      covariates = list(관계이용상하  = 7),
      sims = 100
    )
    med_init <-
      mediation::mediate(
        med_fit,
        out_fit,
        treat = X,
        mediator = M[[i]],
        sims = 100
      )
    test_l[[i]] <- test.modmed(
      med_init,
      covariates.1 = list(관계이용상하  = 3),
      covariates.2 = list(관계이용상하  = 7)
    )
    plot(med2_out, main = paste(X, "-", M[[i]], "-", Y[[j]]), sub = paste(I, "= Low"))
    
    plot(med4_out, main = paste(X, "-", M[[i]], "-", Y[[j]]), sub = paste(I, "= Mid"))
    
    plot(med6_out, main = paste(X, "-", M[[i]], "-", Y[[j]]), sub = paste(I, "= High"))
    out2_l[[i]] <- summary(med2_out)
    out6_l[[i]] <- summary(med6_out)
  }
}

```
]

.footnote[

]




---
name: results3b1
# 결과: 가설3b1: 불안녕감: 정보이용 조절매개

.left-column2[

]


.right-column8[
```{r}
v5889_df  -> df
df %>% 
  mutate(정보이용상하 = case_when(
    관계이용 <= quantile(df$관계이용, probs = .3) ~ 3,
    관계이용 >= quantile(df$관계이용, probs = .7) ~ 7, 
    TRUE ~ 5)) -> df

X <- c("대면빈도", "관계이용", "정보이용", "오락이용")[1]
M <- c("관계_고립", "관계_소속연결")
Y <- c("우울불안", "삶만족")[1]
W <- "성+나이+소득+학력"
I <- "정보이용상하"

par(mfrow = c(2,3))
out2_l <- list()
out6_l <- list()
test_l <- list()
for(i in seq_along(M)) {
  for (j in seq_along(Y)) {
    M_fmla <- paste0(M[[i]], "~", X, "*", I, "+", W)
    Y_fmla <-
      paste0(Y[[j]], "~", M[[i]], "+", X, "*", I, "+", M,"+", W)
    
    med_fit <- lm(M_fmla, data = df)
    out_fit <- lm(Y_fmla, data = df)
    med2_out <- mediation::mediate(
      med_fit,
      out_fit,
      treat = X,
      mediator = M[[i]],
      covariates = list(정보이용상하  = 3),
      sims = 100
    )
    med4_out <- mediation::mediate(
      med_fit,
      out_fit,
      treat = X,
      mediator = M[[i]],
      covariates = list(정보이용상하  = 5),
      sims = 100
    )
    med6_out <- mediation::mediate(
      med_fit,
      out_fit,
      treat = X,
      mediator = M[[i]],
      covariates = list(정보이용상하  = 7),
      sims = 100
    )
    med_init <-
      mediation::mediate(
        med_fit,
        out_fit,
        treat = X,
        mediator = M[[i]],
        sims = 100
      )
    test_l[[i]] <- test.modmed(
      med_init,
      covariates.1 = list(정보이용상하  = 3),
      covariates.2 = list(정보이용상하  = 7)
    )
    plot(med2_out, main = paste(X, "-", M[[i]], "-", Y[[j]]), sub = paste(I, "= Low"))
    
    plot(med4_out, main = paste(X, "-", M[[i]], "-", Y[[j]]), sub = paste(I, "= Mid"))
    
    plot(med6_out, main = paste(X, "-", M[[i]], "-", Y[[j]]), sub = paste(I, "= High"))
    out2_l[[i]] <- summary(med2_out)
    out6_l[[i]] <- summary(med6_out)
  }
}

```
]

.footnote[

]


---
name: results3b2
# 결과: 가설3b2: 안녕감: 정보이용 조절매개

.left-column2[

]


.right-column8[

```{r}
v5889_df  -> df
df %>% 
  mutate(정보이용상하 = case_when(
    관계이용 <= quantile(df$관계이용, probs = .3) ~ 3,
    관계이용 >= quantile(df$관계이용, probs = .7) ~ 7, 
    TRUE ~ 5)) -> df

X <- c("대면빈도", "관계이용", "정보이용", "오락이용")[1]
M <- c("관계_고립", "관계_소속연결")
Y <- c("우울불안", "삶만족")[2]
W <- "성+나이+소득+학력"
I <- "정보이용상하"

par(mfrow = c(2,3))
out2_l <- list()
out6_l <- list()
test_l <- list()
for(i in seq_along(M)) {
  for (j in seq_along(Y)) {
    M_fmla <- paste0(M[[i]], "~", X, "*", I, "+", W)
    Y_fmla <-
      paste0(Y[[j]], "~", M[[i]], "+", X, "*", I, "+", M,"+", W)
    
    med_fit <- lm(M_fmla, data = df)
    out_fit <- lm(Y_fmla, data = df)
    med2_out <- mediation::mediate(
      med_fit,
      out_fit,
      treat = X,
      mediator = M[[i]],
      covariates = list(정보이용상하  = 3),
      sims = 100
    )
    med4_out <- mediation::mediate(
      med_fit,
      out_fit,
      treat = X,
      mediator = M[[i]],
      covariates = list(정보이용상하  = 5),
      sims = 100
    )
    med6_out <- mediation::mediate(
      med_fit,
      out_fit,
      treat = X,
      mediator = M[[i]],
      covariates = list(정보이용상하  = 7),
      sims = 100
    )
    med_init <-
      mediation::mediate(
        med_fit,
        out_fit,
        treat = X,
        mediator = M[[i]],
        sims = 100
      )
    test_l[[i]] <- test.modmed(
      med_init,
      covariates.1 = list(정보이용상하  = 3),
      covariates.2 = list(정보이용상하  = 7)
    )
    plot(med2_out, main = paste(X, "-", M[[i]], "-", Y[[j]]), sub = paste(I, "= Low"))
    
    plot(med4_out, main = paste(X, "-", M[[i]], "-", Y[[j]]), sub = paste(I, "= Mid"))
    
    plot(med6_out, main = paste(X, "-", M[[i]], "-", Y[[j]]), sub = paste(I, "= High"))
    out2_l[[i]] <- summary(med2_out)
    out6_l[[i]] <- summary(med6_out)
  }
}

```

]

.footnote[

]







---
name: results3c1
# 결과: 가설3c1: 불안녕감: 오락이용 조절매개

.left-column2[

]


.right-column8[

```{r}
v5889_df  -> df
df %>% 
  mutate(오락이용상하 = case_when(
    관계이용 <= quantile(df$관계이용, probs = .3) ~ 3,
    관계이용 >= quantile(df$관계이용, probs = .7) ~ 7, 
    TRUE ~ 5)) -> df

X <- c("대면빈도", "관계이용", "정보이용", "오락이용")[1]
M <- c("관계_고립", "관계_소속연결")
Y <- c("우울불안", "삶만족")[1]
W <- "성+나이+소득+학력"
I <- "오락이용상하"

par(mfrow = c(2,3))
out2_l <- list()
out6_l <- list()
test_l <- list()
for(i in seq_along(M)) {
  for (j in seq_along(Y)) {
    M_fmla <- paste0(M[[i]], "~", X, "*", I, "+", W)
    Y_fmla <-
      paste0(Y[[j]], "~", M[[i]], "+", X, "*", I, "+", M,"+", W)
    
    med_fit <- lm(M_fmla, data = df)
    out_fit <- lm(Y_fmla, data = df)
    med2_out <- mediation::mediate(
      med_fit,
      out_fit,
      treat = X,
      mediator = M[[i]],
      covariates = list(오락이용상하  = 3),
      sims = 100
    )
    med4_out <- mediation::mediate(
      med_fit,
      out_fit,
      treat = X,
      mediator = M[[i]],
      covariates = list(오락이용상하  = 5),
      sims = 100
    )
    med6_out <- mediation::mediate(
      med_fit,
      out_fit,
      treat = X,
      mediator = M[[i]],
      covariates = list(오락이용상하  = 7),
      sims = 100
    )
    med_init <-
      mediation::mediate(
        med_fit,
        out_fit,
        treat = X,
        mediator = M[[i]],
        sims = 100
      )
    test_l[[i]] <- test.modmed(
      med_init,
      covariates.1 = list(오락이용상하  = 3),
      covariates.2 = list(오락이용상하  = 7)
    )
    plot(med2_out, main = paste(X, "-", M[[i]], "-", Y[[j]]), sub = paste(I, "= Low"))
    
    plot(med4_out, main = paste(X, "-", M[[i]], "-", Y[[j]]), sub = paste(I, "= Mid"))
    
    plot(med6_out, main = paste(X, "-", M[[i]], "-", Y[[j]]), sub = paste(I, "= High"))
    out2_l[[i]] <- summary(med2_out)
    out6_l[[i]] <- summary(med6_out)
  }
}

```

]

.footnote[

]


---
name: results3c2
# 결과: 가설3c2: 안녕감: 오락이용 조절매개

.left-column2[

]


.right-column8[

```{r}
v5889_df  -> df
df %>% 
  mutate(오락이용상하 = case_when(
    관계이용 <= quantile(df$관계이용, probs = .3) ~ 3,
    관계이용 >= quantile(df$관계이용, probs = .7) ~ 7, 
    TRUE ~ 5)) -> df

X <- c("대면빈도", "관계이용", "정보이용", "오락이용")[1]
M <- c("관계_고립", "관계_소속연결")
Y <- c("우울불안", "삶만족")[2]
W <- "성+나이+소득+학력"
I <- "오락이용상하"

par(mfrow = c(2,3))
out2_l <- list()
out6_l <- list()
test_l <- list()
for(i in seq_along(M)) {
  for (j in seq_along(Y)) {
    M_fmla <- paste0(M[[i]], "~", X, "*", I, "+", W)
    Y_fmla <-
      paste0(Y[[j]], "~", M[[i]], "+", X, "*", I, "+", M,"+", W)
    
    med_fit <- lm(M_fmla, data = df)
    out_fit <- lm(Y_fmla, data = df)
    med2_out <- mediation::mediate(
      med_fit,
      out_fit,
      treat = X,
      mediator = M[[i]],
      covariates = list(오락이용상하  = 3),
      sims = 100
    )
    med4_out <- mediation::mediate(
      med_fit,
      out_fit,
      treat = X,
      mediator = M[[i]],
      covariates = list(오락이용상하  = 5),
      sims = 100
    )
    med6_out <- mediation::mediate(
      med_fit,
      out_fit,
      treat = X,
      mediator = M[[i]],
      covariates = list(오락이용상하  = 7),
      sims = 100
    )
    med_init <-
      mediation::mediate(
        med_fit,
        out_fit,
        treat = X,
        mediator = M[[i]],
        sims = 100
      )
    test_l[[i]] <- test.modmed(
      med_init,
      covariates.1 = list(오락이용상하  = 3),
      covariates.2 = list(오락이용상하  = 7)
    )
    plot(med2_out, main = paste(X, "-", M[[i]], "-", Y[[j]]), sub = paste(I, "= Low"))
    
    plot(med4_out, main = paste(X, "-", M[[i]], "-", Y[[j]]), sub = paste(I, "= Mid"))
    
    plot(med6_out, main = paste(X, "-", M[[i]], "-", Y[[j]]), sub = paste(I, "= High"))
    out2_l[[i]] <- summary(med2_out)
    out6_l[[i]] <- summary(med6_out)
  }
}

```

]

.footnote[

]



---
name: synthesis
# 종합



---
name: discussion1
# 논의



---
name: last

class: middle, inverse

.pull-left[
# **경청해 주셔서 <br>감사합니다.**
<br/>

]

.pull-right[
.right[


]
]
